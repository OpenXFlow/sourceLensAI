> Previously, we looked at [User Management](08_user-management.md).

# Chapter 9: Views
Let's begin exploring this concept. This chapter introduces the concept of "views" in the context of our `20250707_1716_code-sql-db-sample-project`. Views are a powerful tool for simplifying data access and creating reusable queries.
**Why Views?**
Think of a view as a customized window into your database. Imagine you frequently need to generate a report that combines information from several tables. Instead of writing the complex SQL query every time, you can create a view. A view is a virtual table based on a SQL query. It *doesn't* store any data itself. Instead, it provides a simplified and focused representation of the underlying data.
The main purposes of views are:
*   **Simplification:** Hides the complexity of underlying tables and joins.
*   **Security:** Restricts access to sensitive data by only exposing a subset of columns or rows.
*   **Reusability:** Provides a named query that can be used in multiple applications.
*   **Data Abstraction:** Provides a stable interface even if the underlying table structures change.
**Key Concepts**
*   **Virtual Table:** A view appears as a table, but the data is not physically stored in the view itself. The data is derived from the tables referenced in the view's query.
*   **SQL Query Definition:** A view is defined by a SQL query that selects and potentially joins data from other tables.
*   **Data Consistency:** Because views are based on underlying tables, changes to the tables are reflected in the view (assuming the view is defined correctly).
**How Views Work**
When you query a view, the database server executes the SQL query associated with the view definition. The result set of that query is then returned as if it were a regular table. This allows you to treat the view as a table in your queries, simplifying your SQL code.
**Code Examples**
Let's look at some views defined in our project. The following code snippet is extracted from `schema/03_views.sql`.
```python
--- File: schema/03_views.sql ---
-- 03_views.sql
-- Creates simplified views for reporting and easier querying.
CREATE OR REPLACE VIEW recent_orders_summary AS
SELECT 
    o.order_id,
    o.order_date,
    u.email,
    o.total_amount,
    o.status
FROM orders o
JOIN users u ON o.user_id = u.user_id
WHERE o.order_date > (NOW() - INTERVAL '30 days')
ORDER BY o.order_date DESC;
CREATE OR REPLACE VIEW product_sales_report AS
SELECT 
    p.product_id,
    p.name AS product_name,
    SUM(oi.quantity) AS total_units_sold,
    SUM(oi.quantity * oi.price_per_unit) AS total_revenue
FROM order_items oi
JOIN products p ON oi.product_id = p.product_id
GROUP BY p.product_id, p.name
ORDER BY total_revenue DESC;
```
The `recent_orders_summary` view provides a simplified view of recent orders. Instead of querying the `orders` table and joining it with the `users` table every time, you can simply query the `recent_orders_summary` view. It shows only the orders from the last 30 days.
The `product_sales_report` view generates a sales report for each product. It calculates the total units sold and total revenue for each product by joining the `order_items` and `products` tables. This view is helpful for generating reports or performing sales analysis.
**Relationship to Other Concepts**
Views depend on existing [Database Tables](01_database-tables.md) to provide the underlying data. They can also be used in conjunction with [Stored Procedures](09_stored-procedures.md) to create more complex data access patterns.
**Example Scenario**
Imagine you need to display a list of recently placed orders along with the user's email address. Instead of writing a complex JOIN query every time, you can use the `recent_orders_summary` view:
```sql
SELECT * FROM recent_orders_summary;
```
This query will return a result set containing the order ID, order date, user's email address, total amount, and status for all orders placed within the last 30 days.
**Benefits of Using Views**
*   **Improved Readability:** Views can make complex queries easier to understand.
*   **Reduced Code Duplication:** Views can be reused in multiple applications, reducing the need to write the same query multiple times.
*   **Enhanced Security:** Views can restrict access to sensitive data by only exposing a subset of columns or rows.
This concludes our look at this topic.

> Next, we will examine [Architecture Diagrams](10_diagrams.md).


---

*Generated by [SourceLens AI](https://github.com/openXFlow/sourceLensAI) using LLM: `gemini` (cloud) - model: `gemini-2.0-flash` | Language Profile: `Python`*